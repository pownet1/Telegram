{"version":3,"mappings":"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","names":["object","key","DEEP_PATH_JOINER","o","splitted","CheckboxField","options","label","input","onChange","loaded","value","rootScope","apiManagerProxy","state","stateValue","getDeepProperty","checked","span","_i18n","toggle","circle","box","checkSvg","use","bg","border","ripple","simulateEvent","disable","prefixes","maxPrefixLength","setPrefix","country","code","prefix","formatPhoneNumber","originalStr","I18n","str","phoneCode","i","prefixCountry","patterns","searchForPattern","pattern","mostMatchedPatternMatches","mostMatchedPattern","_pattern","patternMatches","k","length","symbol","idx","leftPattern","TelInputField","InputField","telEl","pixelRatio","IS_APPLE","letterSpacing","IS_ANDROID","originalFunc","placeCaretAtEnd","IS_APPLE_MOBILE","formatted","formattedPhoneNumber","e","countries","setCountries","a","b","init","VIRTUAL_COUNTRIES","excludeVirtual","c","names","name","word","abbr","CountryInputField","randomLong","target","defaultName","countryCode","i18n","_countryCode","selectWrapper","arrowDown","selectList","Scrollable","initSelect","getCountryEmoji","liArr","li","wrapped","wrapEmojiText","emoji","IS_EMOJI_SUPPORTED","setInnerHTML","spanEmoji","el","findUpTag","arr","fastSmoothScroll","findUpClassName","mouseDownHandlerAttached","onMouseDown","onKeyPress","filtered","filterCountries","iso2","cancelEvent","countryName","btnNext","btnQr","onFirstMount","inputWrapper","lastCountrySelected","lastCountryCodeSelected","telInputField","lottieLoader","countryInputField","onSubmit","signedCheckboxField","keepSigned","stateStorage","Button","toggleDisability","replaceContent","putPreloader","phone_number","App","authorization","m","err","attachClickEvent","pageSignQR","h4","subtitle","page","tryAgain","nearestDcResult","langPack","done","promise","dcId","dcs","g","_dcs","dbKey","sessionStorage","IS_TOUCH_SUPPORTED","getLanguageChangeButton","Page"],"sources":["../src/helpers/object/getDeepProperty.ts","../src/components/checkboxField.ts","../src/helpers/formatPhoneNumber.ts","../src/components/telInputField.ts","../src/components/countryInputField.ts","../src/pages/pageSignIn.ts"],"sourcesContent":["import {DEEP_PATH_JOINER} from './setDeepProperty';\n\nexport default function getDeepProperty(object: any, key: string | Array<string>) {\n  const splitted = Array.isArray(key) ? key : key.split(DEEP_PATH_JOINER);\n  let o: any = object;\n  for(const key of splitted) {\n    o = o?.[key];\n    if(!o) {\n      break;\n    }\n  }\n\n  return o;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type ListenerSetter from '../helpers/listenerSetter';\nimport ripple from './ripple';\nimport {LangPackKey, _i18n} from '../lib/langPack';\nimport getDeepProperty from '../helpers/object/getDeepProperty';\nimport rootScope from '../lib/rootScope';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport simulateEvent from '../helpers/dom/dispatchEvent';\n\nexport type CheckboxFieldOptions = {\n  text?: LangPackKey,\n  textArgs?: any[],\n  name?: string,\n  round?: boolean,\n  toggle?: boolean,\n  stateKey?: string,\n  stateValues?: any[],\n  stateValueReverse?: boolean,\n  disabled?: boolean,\n  checked?: boolean,\n  restriction?: boolean,\n  withRipple?: boolean,\n  withHover?: boolean,\n  listenerSetter?: ListenerSetter,\n  asRadio?: boolean\n};\nexport default class CheckboxField {\n  public input: HTMLInputElement;\n  public label: HTMLLabelElement;\n  public span: HTMLSpanElement;\n  public listenerSetter: ListenerSetter;\n\n  constructor(options: CheckboxFieldOptions = {}) {\n    const label = this.label = document.createElement('label');\n    label.classList.add('checkbox-field');\n\n    if(options.restriction && !options.toggle) {\n      label.classList.add('checkbox-field-restriction');\n    }\n\n    if(options.round) {\n      label.classList.add('checkbox-field-round');\n    }\n\n    if(options.disabled) {\n      this.toggleDisability(true);\n    }\n\n    this.listenerSetter = options.listenerSetter;\n\n    const input = this.input = document.createElement('input');\n    input.classList.add('checkbox-field-input');\n    input.type = options.asRadio ? 'radio' : 'checkbox';\n    if(options.name) {\n      input[options.asRadio ? 'name' : 'id'] = 'input-' + options.name;\n    }\n\n    if(options.checked) {\n      input.checked = true;\n    }\n\n    if(options.stateKey) {\n      let loaded = options.checked !== undefined;\n      const onChange = () => {\n        if(!loaded) {\n          return;\n        }\n\n        let value: any;\n        if(options.stateValues) {\n          value = options.stateValues[input.checked ? 1 : 0];\n        } else {\n          value = input.checked;\n\n          if(options.stateValueReverse) {\n            value = !value;\n          }\n        }\n\n        rootScope.managers.appStateManager.setByKey(options.stateKey, value);\n      };\n\n      !loaded && apiManagerProxy.getState().then((state) => {\n        loaded = true;\n        const stateValue = getDeepProperty(state, options.stateKey);\n        let checked: boolean;\n        if(options.stateValues) {\n          checked = options.stateValues.indexOf(stateValue) === 1;\n        } else {\n          checked = stateValue;\n\n          if(options.stateValueReverse) {\n            checked = !checked;\n          }\n        }\n\n        this.setValueSilently(checked);\n      });\n\n      if(options.listenerSetter) options.listenerSetter.add(input)('change', onChange);\n      else input.addEventListener('change', onChange);\n    }\n\n    let span: HTMLSpanElement;\n    if(options.text) {\n      span = this.span = document.createElement('span');\n      span.classList.add('checkbox-caption');\n      _i18n(span, options.text, options.textArgs);\n    } else {\n      label.classList.add('checkbox-without-caption');\n    }\n\n    label.append(input);\n\n    if(options.toggle) {\n      label.classList.add('checkbox-field-toggle');\n\n      if(options.restriction) {\n        label.classList.add('checkbox-field-toggle-restriction');\n      }\n\n      const toggle = document.createElement('div');\n      toggle.classList.add('checkbox-toggle');\n      const circle = document.createElement('div');\n      circle.classList.add('checkbox-toggle-circle');\n      toggle.append(circle);\n      label.append(toggle);\n    } else {\n      const box = document.createElement('div');\n      box.classList.add('checkbox-box');\n\n      const checkSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      checkSvg.classList.add('checkbox-box-check');\n      checkSvg.setAttributeNS(null, 'viewBox', '0 0 24 24');\n      const use = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n      use.setAttributeNS(null, 'href', '#check');\n      use.setAttributeNS(null, 'x', '-1');\n      checkSvg.append(use);\n\n      const bg = document.createElement('div');\n      bg.classList.add('checkbox-box-background');\n\n      const border = document.createElement('div');\n      border.classList.add('checkbox-box-border');\n\n      box.append(border, bg, checkSvg);\n\n      label.append(box);\n    }\n\n    if(span) {\n      label.append(span);\n    }\n\n    if(options.withRipple) {\n      label.classList.add('checkbox-ripple', 'hover-effect');\n      ripple(label, undefined, undefined, true);\n      // label.prepend(input);\n    } else if(options.withHover) {\n      label.classList.add('hover-effect');\n    }\n  }\n\n  get checked() {\n    return this.input.checked;\n  }\n\n  set checked(checked: boolean) {\n    /* if(this.checked === checked) {\n      return;\n    } */\n\n    this.setValueSilently(checked);\n    simulateEvent(this.input, 'change');\n  }\n\n  public setValueSilently(checked: boolean) {\n    this.input.checked = checked;\n  }\n\n  public isDisabled() {\n    return this.label.classList.contains('checkbox-disabled');\n  }\n\n  public toggleDisability(disable: boolean) {\n    this.label.classList.toggle('checkbox-disabled', disable);\n    this.input.disabled = disable;\n    return () => this.toggleDisability(!disable);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n from '../lib/langPack';\n\nlet sortedCountries: HelpCountry[];\ntype PrefixCountry = {country: HelpCountry, code: HelpCountryCode};\nconst prefixes: Map<string, PrefixCountry> = new Map();\nlet maxPrefixLength = 0;\nconst setPrefix = (country: HelpCountry, code: HelpCountryCode, prefix: string = '') => {\n  prefix = code.country_code + prefix;\n  /* if(prefixes.has(prefix)) {\n    console.error('asdasdasd', prefixes.get(prefix), country, code);\n  } */\n  maxPrefixLength = Math.max(maxPrefixLength, prefix.length);\n  prefixes.set(prefix, {country, code});\n};\n\nexport function formatPhoneNumber(originalStr: string): {\n  formatted: string,\n  country: HelpCountry,\n  code: HelpCountryCode,\n  leftPattern: string\n} {\n  originalStr = originalStr || '';\n\n  if(!prefixes.size) {\n    I18n.countriesList.forEach((country) => {\n      country.country_codes.forEach((code) => {\n        if(code.prefixes) {\n          code.prefixes.forEach((prefix) => {\n            setPrefix(country, code, prefix);\n          });\n        } else {\n          setPrefix(country, code);\n        }\n      });\n    });\n  }\n\n  // return {formatted: originalStr, country: undefined as any, leftPattern: ''};\n  let str = originalStr.replace(/\\D/g, '');\n  const phoneCode = str.slice(0, maxPrefixLength);\n\n  // //console.log('str', str, phoneCode);\n  // if(!sortedCountries) {\n  //   sortedCountries = I18n.countriesList.slice().sort((a, b) => b.country_codes[0].country_code.length - a.country_codes[0].country_code.length);\n  // }\n\n  // let country = sortedCountries.find((c) => {\n  //   return c.country_codes.find((c) => phoneCode.indexOf(c.replace(/\\D/g, '')) === 0);\n  // });\n\n  let prefixCountry: PrefixCountry;\n  for(let i = phoneCode.length - 1; i >= 0; --i) { // lookup for country by prefix\n    prefixCountry = prefixes.get(phoneCode.slice(0, i + 1));\n    if(prefixCountry) {\n      break;\n    }\n  }\n\n  if(!prefixCountry) {\n    return {\n      formatted: str,\n      country: undefined,\n      code: undefined,\n      leftPattern: ''\n    };\n  }\n\n  // country = /* PhoneCodesMain[country.phoneCode] ||  */country;\n  const country = prefixCountry.country;\n\n  const patterns = prefixCountry.code.patterns || [];\n  const searchForPattern = str.slice(prefixCountry.code.country_code.length); // splice country code\n  let pattern = '', mostMatchedPatternMatches = 0, mostMatchedPattern = '';\n  for(let i = patterns.length - 1; i >= 0; --i) {\n    pattern = patterns[i];\n\n    const _pattern = pattern.replace(/ /g, '');\n    let patternMatches = 0;\n    for(let k = 0, length = Math.min(searchForPattern.length, _pattern.length); k < length; ++k) {\n      if(searchForPattern[k] === _pattern[k]) {\n        patternMatches += 1.01;\n      } else if(_pattern[k] === 'X') {\n        ++patternMatches;\n      } else {\n        patternMatches = 0;\n        break;\n      }\n    }\n\n    if(patternMatches > mostMatchedPatternMatches) {\n      mostMatchedPatternMatches = patternMatches;\n      mostMatchedPattern = pattern;\n    }\n  }\n\n  pattern = mostMatchedPattern || pattern;\n  pattern = pattern.replace(/\\d/g, 'X');\n\n  pattern = prefixCountry.code.country_code + ' ' + pattern;\n  // let pattern = country.pattern || country.phoneCode;\n  pattern.split('').forEach((symbol, idx) => {\n    if(symbol === ' ' && str[idx] !== ' ' && str.length > idx) {\n      str = str.slice(0, idx) + ' ' + str.slice(idx);\n    }\n  });\n\n  /* if(country.pattern) {\n    str = str.slice(0, country.pattern.length);\n  } */\n\n  let leftPattern = pattern && pattern.length > str.length ? pattern.slice(str.length) : '';\n  if(leftPattern) {\n    /* const length = str.length;\n    leftPattern = leftPattern.split('').map((_, idx) => (length + idx).toString().slice(-1)).join(''); */\n    leftPattern = leftPattern.replace(/X/g, '‒');\n    // leftPattern = leftPattern.replace(/X/g, '0');\n  }\n\n  return {formatted: str, country, code: prefixCountry.code, leftPattern};\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {formatPhoneNumber} from '../helpers/formatPhoneNumber';\nimport {IS_APPLE, IS_ANDROID, IS_APPLE_MOBILE} from '../environment/userAgent';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport default class TelInputField extends InputField {\n  private pasted = false;\n  public lastValue = '';\n\n  constructor(options: InputFieldOptions & {\n    onInput?: (formatted: ReturnType<typeof formatPhoneNumber>) => void\n  } = {}) {\n    super({\n      label: 'Contacts.PhoneNumber.Placeholder',\n      // plainText: true,\n      name: 'phone',\n      ...options\n    });\n\n    this.container.classList.add('input-field-phone');\n\n    const telEl = this.input;\n    if(telEl instanceof HTMLInputElement) {\n      telEl.type = 'tel';\n      telEl.autocomplete = 'rr55RandomRR55';\n    } else {\n      telEl.inputMode = 'decimal';\n\n      const pixelRatio = window.devicePixelRatio;\n      if(pixelRatio > 1) {\n        let letterSpacing: number;\n        if(IS_APPLE) {\n          letterSpacing = pixelRatio * -.16;\n        } else if(IS_ANDROID) {\n          letterSpacing = 0;\n        }\n\n        telEl.style.setProperty('--letter-spacing', letterSpacing + 'px');\n      }\n\n      const originalFunc = this.setValueSilently.bind(this);\n      this.setValueSilently = (value) => {\n        originalFunc(value);\n        placeCaretAtEnd(this.input, true);\n      };\n    }\n\n    telEl.addEventListener('input', () => {\n      // console.log('input', this.value);\n      telEl.classList.remove('error');\n\n      const value = this.value;\n      const diff = Math.abs(value.length - this.lastValue.length);\n      if(diff > 1 && !this.pasted && IS_APPLE_MOBILE) {\n        this.setValueSilently(this.lastValue + value);\n      }\n\n      this.pasted = false;\n\n      this.setLabel();\n\n      let formattedPhoneNumber: ReturnType<typeof formatPhoneNumber>;\n      let formatted: string, country: HelpCountry, countryCode: HelpCountryCode, leftPattern = '';\n      if(this.value.replace(/\\++/, '+') === '+') {\n        this.setValueSilently('+');\n      } else {\n        formattedPhoneNumber = formatPhoneNumber(this.value);\n        formatted = formattedPhoneNumber.formatted;\n        country = formattedPhoneNumber.country;\n        leftPattern = formattedPhoneNumber.leftPattern;\n        countryCode = formattedPhoneNumber.code;\n        this.setValueSilently(this.lastValue = formatted ? '+' + formatted : '');\n      }\n\n      telEl.dataset.leftPattern = leftPattern/* .replace(/X/g, '0') */;\n\n      // console.log(formatted, country);\n\n      options.onInput && options.onInput(formattedPhoneNumber);\n    });\n\n    telEl.addEventListener('paste', () => {\n      this.pasted = true;\n      // console.log('paste', telEl.value);\n    });\n\n    /* telEl.addEventListener('change', (e) => {\n      console.log('change', telEl.value);\n    }); */\n\n    telEl.addEventListener('keypress', (e) => {\n      // console.log('keypress', this.value);\n      const key = e.key;\n      if(/\\D/.test(key) && !(e.metaKey || e.ctrlKey) && key !== 'Backspace' && !(key === '+' && e.shiftKey/*  && !this.value */)) {\n        e.preventDefault();\n        return false;\n      }\n    });\n\n    /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n      this.removeAttribute('readonly'); // fix autocomplete\n    });*/\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_EMOJI_SUPPORTED from '../environment/emojiSupport';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport findUpClassName from '../helpers/dom/findUpClassName';\nimport findUpTag from '../helpers/dom/findUpTag';\nimport setInnerHTML from '../helpers/dom/setInnerHTML';\nimport fastSmoothScroll from '../helpers/fastSmoothScroll';\nimport {randomLong} from '../helpers/random';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n, {i18n} from '../lib/langPack';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport rootScope from '../lib/rootScope';\nimport {getCountryEmoji} from '../vendor/emoji';\nimport InputField, {InputFieldOptions} from './inputField';\nimport Scrollable from './scrollable';\n\nlet countries: HelpCountry.helpCountry[];\nconst setCountries = () => {\n  countries = I18n.countriesList\n  .filter((country) => !country.pFlags?.hidden)\n  .sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n};\n\nlet init = () => {\n  init = undefined;\n  setCountries();\n  rootScope.addEventListener('language_change', () => {\n    setCountries();\n  });\n};\n\nconst VIRTUAL_COUNTRIES = new Set(['FT']);\n\nexport function filterCountries(value: string, excludeVirtual?: boolean) {\n  init?.();\n\n  value = value.toLowerCase();\n  const filtered = countries.filter((c) => {\n    if(excludeVirtual && VIRTUAL_COUNTRIES.has(c.iso2)) {\n      return false;\n    }\n\n    const names = [\n      c.name,\n      c.default_name,\n      c.iso2\n    ];\n\n    names.filter(Boolean).forEach((name) => {\n      const abbr = name.split(' ').filter((word) => /\\w/.test(word)).map((word) => word[0]).join('');\n      if(abbr.length > 1) {\n        names.push(abbr);\n      }\n    });\n\n    const good = !!names.filter(Boolean).find((str) => str.toLowerCase().indexOf(value) !== -1)/*  === 0 */;// i.test(c.name);\n    return good;\n  });\n\n  return filtered;\n}\n\nexport function sortCountries(countries: HelpCountry.helpCountry[]) {\n  return countries.sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n}\n\nexport default class CountryInputField extends InputField {\n  private lastCountrySelected: HelpCountry;\n  private lastCountryCodeSelected: HelpCountryCode;\n\n  private hideTimeout: number;\n  private selectWrapper: HTMLElement;\n\n  private liMap: Map<string, HTMLLIElement[]>;\n\n  constructor(public options: InputFieldOptions & {\n    onCountryChange?: (country: HelpCountry.helpCountry, code: HelpCountryCode.helpCountryCode) => void,\n    noPhoneCodes?: boolean\n  } = {}) {\n    super({\n      label: 'Country',\n      name: randomLong(),\n      ...options\n    });\n\n    init?.();\n\n    this.liMap = new Map();\n\n    this.container.classList.add('input-select');\n\n    const selectWrapper = this.selectWrapper = document.createElement('div');\n    selectWrapper.classList.add('select-wrapper', 'z-depth-3', 'hide');\n\n    const arrowDown = document.createElement('span');\n    arrowDown.classList.add('arrow', 'arrow-down');\n    this.container.append(arrowDown);\n\n    const selectList = document.createElement('ul');\n    selectWrapper.appendChild(selectList);\n\n    const scroll = new Scrollable(selectWrapper);\n\n    let initSelect = () => {\n      initSelect = null;\n\n      countries.forEach((c) => {\n        if(options.noPhoneCodes && VIRTUAL_COUNTRIES.has(c.iso2)) {\n          return;\n        }\n\n        const emoji = getCountryEmoji(c.iso2);\n\n        const liArr: Array<HTMLLIElement> = [];\n        for(let i = 0, length = Math.min(c.country_codes.length, options.noPhoneCodes ? 1 : Infinity); i < length; ++i) {\n          const countryCode = c.country_codes[i];\n          const li = document.createElement('li');\n\n          const wrapped = wrapEmojiText(emoji);\n          if(IS_EMOJI_SUPPORTED) {\n            const spanEmoji = document.createElement('span');\n            setInnerHTML(spanEmoji, wrapped);\n            li.append(spanEmoji);\n          } else {\n            setInnerHTML(li, wrapped);\n          }\n\n          const el = i18n(c.default_name as any);\n          el.dataset.defaultName = c.default_name;\n          li.append(el);\n\n          if(!options.noPhoneCodes) {\n            const span = document.createElement('span');\n            span.classList.add('phone-code');\n            span.innerText = '+' + countryCode.country_code;\n            li.appendChild(span);\n          }\n\n          liArr.push(li);\n          selectList.append(li);\n        }\n\n        this.liMap.set(c.iso2, liArr);\n      });\n\n      selectList.addEventListener('mousedown', (e) => {\n        if(e.button !== 0) { // other buttons but left shall not pass\n          return;\n        }\n\n        const target = findUpTag(e.target, 'LI')\n        this.selectCountryByTarget(target);\n        // console.log('clicked', e, countryName, phoneCode);\n      });\n\n      this.container.appendChild(selectWrapper);\n    };\n\n    initSelect();\n\n    this.input.addEventListener('focus', (e) => {\n      if(initSelect) {\n        initSelect();\n      } else {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) return;\n          arr.forEach((li) => li.style.display = '');\n        });\n      }\n\n      clearTimeout(this.hideTimeout);\n      this.hideTimeout = undefined;\n\n      selectWrapper.classList.remove('hide');\n      void selectWrapper.offsetWidth; // reflow\n      selectWrapper.classList.add('active');\n\n      this.select();\n\n      fastSmoothScroll({\n        // container: page.pageEl.parentElement.parentElement,\n        container: findUpClassName(this.container, 'scrollable-y'),\n        element: this.input,\n        position: 'start',\n        margin: 4\n      });\n\n      setTimeout(() => {\n        if(!mouseDownHandlerAttached) {\n          document.addEventListener('mousedown', onMouseDown, {capture: true});\n          mouseDownHandlerAttached = true;\n        }\n      }, 0);\n    });\n\n    let mouseDownHandlerAttached = false;\n    const onMouseDown = (e: MouseEvent) => {\n      if(findUpClassName(e.target, 'input-select')) {\n        return;\n      }\n      if(e.target === this.input) {\n        return;\n      }\n\n      this.hidePicker();\n      document.removeEventListener('mousedown', onMouseDown, {capture: true});\n      mouseDownHandlerAttached = false;\n    };\n\n    /* false && this.input.addEventListener('blur', function(this: typeof this.input, e) {\n      hidePicker();\n\n      e.cancelBubble = true;\n    }, {capture: true}); */\n\n    const onKeyPress = (e: KeyboardEvent) => {\n      const key = e.key;\n      if(e.ctrlKey || key === 'Control') return false;\n\n      // let i = new RegExp('^' + this.value, 'i');\n      const filtered = new Set(filterCountries(this.value).map((c) => c.iso2));\n      this.liMap.forEach((arr, iso2) => {\n        arr.forEach((li) => li.style.display = filtered.has(iso2) ? '' : 'none');\n      });\n\n      // Код ниже автоматически выберет страну если она осталась одна при поиске\n      /* if(matches.length === 1 && matches[0].li.length === 1) {\n        if(matches[0].name === lastCountrySelected) return false;\n        //console.log('clicking', matches[0]);\n\n        var clickEvent = document.createEvent('MouseEvents');\n        clickEvent.initEvent('mousedown', true, true);\n        matches[0].li[0].dispatchEvent(clickEvent);\n        return false;\n      } else  */if(!filtered.size) {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) {\n            return;\n          }\n\n          arr.forEach((li) => li.style.display = '');\n        });\n      } else if(filtered.size === 1 && key === 'Enter') {\n        cancelEvent(e);\n        this.selectCountryByTarget(this.liMap.get([...filtered][0])[0]);\n      }\n    };\n\n    this.input.addEventListener('keyup', onKeyPress);\n    this.input.addEventListener('keydown', (e) => {\n      if(e.key === 'Enter') {\n        onKeyPress(e);\n      }\n    });\n\n    arrowDown.addEventListener('mousedown', (e) => {\n      if(this.input.matches(':focus')) {\n        this.hidePicker();\n        this.input.blur();\n      } else {\n        e.cancelBubble = true;\n        e.preventDefault();\n        this.input.focus();\n      }\n    });\n  }\n\n  public getSelected() {\n    return {country: this.lastCountrySelected, code: this.lastCountryCodeSelected};\n  }\n\n  public hidePicker = () => {\n    if(this.hideTimeout !== undefined) return;\n    this.selectWrapper.classList.remove('active');\n    this.hideTimeout = window.setTimeout(() => {\n      this.selectWrapper.classList.add('hide');\n      this.hideTimeout = undefined;\n    }, 200);\n  }\n\n  public selectCountryByTarget = (target: HTMLElement) => {\n    const defaultName = target.querySelector<HTMLElement>('[data-default-name]').dataset.defaultName;\n    const phoneCodeEl = target.querySelector<HTMLElement>('.phone-code');\n    const phoneCode = phoneCodeEl?.innerText;\n    const countryCode = phoneCode && phoneCode.replace(/\\D/g, '');\n\n    this.value = i18n(defaultName as any);\n    this.lastCountrySelected = countries.find((c) => c.default_name === defaultName);\n    this.lastCountryCodeSelected = countryCode && this.lastCountrySelected.country_codes.find((_countryCode) => _countryCode.country_code === countryCode);\n\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n    this.hidePicker();\n  }\n\n  public selectCountryByIso2(iso2: string) {\n    this.selectCountryByTarget(this.liMap.get(iso2)[0]);\n  }\n\n  public override(country: HelpCountry, code: HelpCountryCode, countryName?: string) {\n    this.setValueSilently(country ? i18n(country.default_name as any) : countryName);\n    this.lastCountrySelected = country;\n    this.lastCountryCodeSelected = code;\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport Page from './page';\nimport CheckboxField from '../components/checkboxField';\nimport Button from '../components/button';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport App from '../config/app';\nimport I18n, {_i18n, i18n} from '../lib/langPack';\nimport lottieLoader from '../lib/rlottie/lottieLoader';\nimport ripple from '../components/ripple';\nimport pageSignQR from './pageSignQR';\nimport getLanguageChangeButton from '../components/languageChangeButton';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport toggleDisability from '../helpers/dom/toggleDisability';\nimport sessionStorage from '../lib/sessionStorage';\nimport {DcAuthKey} from '../types';\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport stateStorage from '../lib/stateStorage';\nimport rootScope from '../lib/rootScope';\nimport TelInputField from '../components/telInputField';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport CountryInputField from '../components/countryInputField';\n\n// import _countries from '../countries_pretty.json';\nlet btnNext: HTMLButtonElement = null, btnQr: HTMLButtonElement;\n\nconst onFirstMount = () => {\n  /* if(Modes.test) {\n    Countries.push({\n      _: 'help.country',\n      default_name: 'Test Country',\n      country_codes: [{\n        _: 'help.countryCode',\n        country_code: '999 66',\n        patterns: ['999 66 XXX XX']\n      }],\n      iso2: 'KK'\n    });\n\n    console.log('Added test country to list!');\n  } */\n\n  // const countries: Country[] = _countries.default.filter((c) => c.emoji);\n  // const countries: Country[] = Countries.filter((c) => c.emoji).sort((a, b) => a.name.localeCompare(b.name));\n  // const countries = I18n.countriesList.filter((country) => !country.pFlags?.hidden);\n\n  const inputWrapper = document.createElement('div');\n  inputWrapper.classList.add('input-wrapper');\n\n  let lastCountrySelected: HelpCountry, lastCountryCodeSelected: HelpCountryCode;\n  const countryInputField = new CountryInputField({\n    onCountryChange: (country, code) => {\n      lastCountrySelected = country, lastCountryCodeSelected = code;\n\n      if(!code) {\n        return;\n      }\n\n      telInputField.value = telInputField.lastValue = '+' + code.country_code;\n      setTimeout(() => {\n        telEl.focus();\n        placeCaretAtEnd(telEl, true);\n      }, 0);\n    }\n  });\n\n  const telInputField = new TelInputField({\n    onInput: (formatted) => {\n      lottieLoader.loadLottieWorkers();\n\n      const {country, code} = formatted || {};\n      const countryName = country ? country.name || country.default_name : ''/* 'Unknown' */;\n      if(countryName !== countryInputField.value && (\n        !lastCountrySelected ||\n          !country ||\n          !code || (\n          lastCountrySelected !== country &&\n            lastCountryCodeSelected.country_code !== code.country_code\n        )\n      )\n      ) {\n        countryInputField.override(country, code, countryName);\n      }\n\n      // if(country && (telInputField.value.length - 1) >= (country.pattern ? country.pattern.length : 9)) {\n      if(country || (telInputField.value.length - 1) > 1) {\n        btnNext.style.visibility = '';\n      } else {\n        btnNext.style.visibility = 'hidden';\n      }\n    }\n  });\n\n  const telEl = telInputField.input;\n\n  telEl.addEventListener('keypress', (e) => {\n    // console.log('keypress', this.value);\n    if(!btnNext.style.visibility &&/* this.value.length >= 9 && */ e.key === 'Enter') {\n      return onSubmit();\n    }\n  });\n\n  /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n    this.removeAttribute('readonly'); // fix autocomplete\n  });*/\n\n  const signedCheckboxField = new CheckboxField({\n    text: 'Login.KeepSigned',\n    name: 'keepSession',\n    withRipple: true,\n    checked: true\n  });\n\n  signedCheckboxField.input.addEventListener('change', () => {\n    const keepSigned = signedCheckboxField.checked;\n    rootScope.managers.appStateManager.pushToState('keepSigned', keepSigned);\n  });\n\n  apiManagerProxy.getState().then((state) => {\n    if(!stateStorage.isAvailable()) {\n      signedCheckboxField.checked = false;\n      signedCheckboxField.label.classList.add('checkbox-disabled');\n    } else {\n      signedCheckboxField.checked = state.keepSigned;\n    }\n  });\n\n  btnNext = Button('btn-primary btn-color-primary', {text: 'Login.Next'});\n  btnNext.style.visibility = 'hidden';\n\n  const onSubmit = (e?: Event) => {\n    if(e) {\n      cancelEvent(e);\n    }\n\n    const toggle = toggleDisability([/* telEl, countryInput,  */btnNext, btnQr], true);\n\n    replaceContent(btnNext, i18n('PleaseWait'));\n    putPreloader(btnNext);\n\n    // return;\n\n    const phone_number = telInputField.value;\n    rootScope.managers.apiManager.invokeApi('auth.sendCode', {\n      phone_number: phone_number,\n      api_id: App.id,\n      api_hash: App.hash,\n      settings: {\n        _: 'codeSettings', // that's how we sending Type\n        pFlags: {}\n      }\n      // lang_code: navigator.language || 'en'\n    }).then((code) => {\n      // console.log('got code', code);\n\n      if(code._ === 'auth.sentCodeSuccess') {\n        const {authorization} = code;\n        if(authorization._ === 'auth.authorization') {\n          rootScope.managers.apiManager.setUser(authorization.user);\n\n          // import('./pageIm').then((m) => {\n          //   m.default.mount();\n          // });\n        }\n      }\n\n      import('./pageAuthCode').then((m) => m.default.mount(Object.assign(code, {phone_number: phone_number})));\n    }).catch((err) => {\n      toggle();\n\n      switch(err.type) {\n        case 'PHONE_NUMBER_INVALID':\n          telInputField.setError();\n          replaceContent(telInputField.label, i18n('Login.PhoneLabelInvalid'));\n          telEl.classList.add('error');\n          replaceContent(btnNext, i18n('Login.Next'));\n          break;\n        default:\n          console.error('auth.sendCode error:', err);\n          btnNext.innerText = err.type;\n          break;\n      }\n    });\n  };\n\n  attachClickEvent(btnNext, onSubmit);\n\n  btnQr = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: 'Login.QR.Login'});\n\n  const qrMounted = false;\n  btnQr.addEventListener('click', () => {\n    pageSignQR.mount();\n    /* const promise = import('./pageSignQR');\n    btnQr.disabled = true;\n\n    let preloaderDiv: HTMLElement;\n    if(!qrMounted) {\n      preloaderDiv = putPreloader(btnQr);\n      qrMounted = true;\n    }\n\n    promise.then((module) => {\n      module.default.mount();\n\n      setTimeout(() => {\n        btnQr.removeAttribute('disabled');\n        if(preloaderDiv) {\n          preloaderDiv.remove();\n        }\n      }, 200);\n    }); */\n  });\n\n  inputWrapper.append(countryInputField.container, telInputField.container, signedCheckboxField.label, btnNext, btnQr);\n\n  const h4 = document.createElement('h4');\n  h4.classList.add('text-center');\n  _i18n(h4, 'Login.Title');\n\n  const subtitle = document.createElement('div');\n  subtitle.classList.add('subtitle', 'text-center');\n  _i18n(subtitle, 'Login.StartText');\n\n  page.pageEl.querySelector('.container').append(h4, subtitle, inputWrapper);\n\n  const tryAgain = () => {\n    rootScope.managers.apiManager.invokeApi('help.getNearestDc').then((nearestDcResult) => {\n      const langPack = stateStorage.getFromCache('langPack');\n      if(langPack && !langPack.countries?.hash) {\n        I18n.getLangPack(langPack.lang_code).then(() => {\n          telInputField.simulateInputEvent();\n        });\n      }\n\n      const dcs = new Set([1, 2, 3, 4, 5]);\n      const done: number[] = [nearestDcResult.this_dc];\n\n      let promise: Promise<any>;\n      if(nearestDcResult.nearest_dc !== nearestDcResult.this_dc) {\n        promise = rootScope.managers.apiManager.getNetworkerVoid(nearestDcResult.nearest_dc).then(() => {\n          done.push(nearestDcResult.nearest_dc);\n        });\n      }\n\n      (promise || Promise.resolve()).then(() => {\n        done.forEach((dcId) => {\n          dcs.delete(dcId);\n        });\n\n        const _dcs = [...dcs];\n        const g = async(): Promise<void> => {\n          const dcId = _dcs.shift();\n          if(!dcId) return;\n\n          const dbKey: DcAuthKey = `dc${dcId}_auth_key` as any;\n          const key = await sessionStorage.get(dbKey);\n          if(key) {\n            return g();\n          }\n\n          setTimeout(() => { // * если одновременно запросить все нетворкеры, не будет проходить запрос на код\n            rootScope.managers.apiManager.getNetworkerVoid(dcId/* , {fileDownload: true} */).finally(g);\n          }, /* done.includes(dcId) ? 0 :  */3000);\n        };\n\n        g();\n      });\n\n      return nearestDcResult;\n    }).then((nearestDcResult) => {\n      if(!countryInputField.value.length && !telInputField.value.length) {\n        countryInputField.selectCountryByIso2(nearestDcResult.country);\n      }\n\n      // console.log('woohoo', nearestDcResult, country);\n    })// .catch(tryAgain);\n  };\n\n  if(!IS_TOUCH_SUPPORTED) {\n    setTimeout(() => {\n      telEl.focus();\n    }, 0);\n  }\n\n  getLanguageChangeButton(inputWrapper);\n\n  tryAgain();\n};\n\nconst page = new Page('page-sign', true, onFirstMount, () => {\n  if(btnNext) {\n    replaceContent(btnNext, i18n('Login.Next'));\n    ripple(btnNext, undefined, undefined, true);\n    btnNext.removeAttribute('disabled');\n  }\n\n  if(btnQr) {\n    btnQr.removeAttribute('disabled');\n  }\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignIn'});\n});\n\nexport default page;\n"],"file":"pageSignIn-434b1a94.js"}